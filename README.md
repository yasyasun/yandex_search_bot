# Telegram-бот для анализа позиций доменов в Яндекс.Поиске

***

## Как запустить бот:
- Скачать скрипт
- Установить зависимости: `pip install -r requirements.txt`
- Создать telegram-бота у [BotFather](https://t.me/BotFather) и получить токен
- Получить доступ к [Yandex Search API](https://yandex.cloud/ru/services/search-api)
- Заполнить BOT_TOKEN и YANDEX_API_KEY
- Запустить бота: `python main.py`

***

Этот Telegram-бот автоматизирует анализ позиций доменов в результатах поиска Яндекса по списку запросов. Работа бота проходит в несколько этапов:

1. Запуск бота: После отправки команды **/start**, бот приветствует пользователя и объясняет, как использовать команду /yandex_search.

2. Команда **/yandex_search**: Запускает процесс анализа. Бот запрашивает у пользователя файл с запросами в формате CSV или TXT.
   - CSV-файл: Запросы должны находиться в первом столбце.
   - TXT-файл: Каждый запрос на новой строке.

3. Обработка файла: Бот проверяет формат файла (CSV или TXT) и извлекает список поисковых запросов. В случае пустого или некорректного файла, выводится сообщение об ошибке.

4. Запрос доменов: После успешной обработки файла, бот запрашивает у пользователя список доменов (через пробел), позиции которых необходимо определить.

5. Запрос к API Яндекса: Бот отправляет запросы к API Яндекса для каждого запроса из файла, используя предоставленный API-ключ. Между запросами встроена пауза для соблюдения ограничений API.

6. Парсинг результатов: XML-ответ от Яндекса обрабатывается, и извлекаются позиции указанных доменов.

7. Расчет долей: Результаты поиска записываются в CSV-файл. Затем рассчитываются доли доменов в топ-1, топ-3, топ-5 и топ-10 позициях.

8. Вывод результатов: Пользователю отправляется CSV-файл с результатами поиска и таблица с рассчитанными долями доменов.

***

Что можно улучшить:
- Асинхронность: Использовать асинхронные запросы для ускорения обработки большого количества запросов.
- Ведение логов: Добавить логирование для отладки и мониторинга.
- Поддержка разных типов файлов: Добавить возможность обработки файлов в других форматах, помимо CSV и TXT.
- Кэширование результатов: Кэшировать результаты запросов к Яндексу для уменьшения нагрузки на API и ускорения работы бота.